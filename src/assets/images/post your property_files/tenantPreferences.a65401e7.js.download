define("doT!modules/listProperty/views/tenantPreferences",function(){return function(e){var t='<div class="accordian-box ';e.isScreening&&(t+="open"),t+=' js-tenant-accordian-box" data-type="accordian"><h3 class="heading"><a href="#">Tenant Preferences <span class="new-highligher"> New</span><i class="icon-arrow-bottom fs20 pull-right"></i></a></h3><div class="row no-margin">';var o=e.questions;if(o)for(var i,n=-1,r=o.length-1;r>n;)i=o[n+=1],t+=' <div class="col-lg-12 col-md-12 col-sm-12 no-padding less-mr-top clearfix"> <div class="col-lg-12 col-md-12 col-sm-12"> ',"radio"===i.type?(t+=' <div data-module="controls" id="'+e.questionIdPrefix+"-"+i.id+'" class="',i.dependency&&(t+="hide js-dependent-ques "+e.dependentPrefix+"-"+i.dependency.parentQuestionId+" "+e.dependentPrefix+"-"+i.dependency.parentQuestionId+"-"+i.dependency.dependencyAnswer),t+='"> <script type="text/x-config"> { "type": "radioButton", "hideSelect": true, "broadcastValueEnter": true,"label": "'+i.title+" ","true"==e.checkValid&&(t+="<sup>*</sup>"),t+='", "data": { "list": '+JSON.stringify(i.answerOptions)+'},"error": "Please choose '+i.title+'" } </script> </div> '):t+='<h4 class="small-headings js-has-tool-tip">'+i.title+'</h4> <div data-module="controls" id="tenant-preference-'+i.id+'" class="description skip-valid"> <script type="text/x-config"> { "type": "textArea","placeholder": "Tell us your special requirements here...","error": "Please enter '+i.title+'" } </script> </div> ',t+=" </div> </div> ";return t+="</div></div>"}}),define("services/listingService",["services/apiService","services/urlService","services/utils"],function(e,t,o){var i="listingService";return Box.Application.addService(i,function(){function o(t){return e.get(c.getListings(t))}function i(t){return e.postJSON(c.markListingForRepost(t))}function n(t){return e.patch(c.repostListings({listingId:t}))}function r(t){return e.get(c.getListingsToImproveScore(t))}function s(t){return e.get(c.originalDescription({listingId:t}))}function a(){return e.get(c.getTenantPreferencesQuestionaire())}var c={getListings:function(e){var o=t.getAllUrlParam();e=$.extend({},o,e);var i="/listing-repost";return e?t.getURLWithSelectors(i,e):i},markListingForRepost:function(e){var o="xhr/listingService/markPendingRepost";return t.getURLWithSelectors(o,e)},repostListings:function(e){var t=e.listingId;return"/xhr/delete/repost?listingId="+t},getListingsToImproveScore:function(e){return"/xhr/sellerListing/getListingsToImproveScore?sellerId="+e},originalDescription:function(e){var t=e.listingId;return"/xhr/sellerListing/originalDescription?listingIds="+t},getTenantPreferencesQuestionaire:function(){return"/xhr/master-profiling-questionaire"}};return{getListings:o,markForRepost:i,repostListing:n,getListingsToImproveScore:r,getOriginalDescription:s,getTenantPreferencesQuestionaire:a}}),Box.Application.getService(i)}),define("modules/iconList/scripts/iconListService",[],function(){return Box.Application.addService("iconListService",function(e){var t={},o={amenities:[{icon:"parking",text:"Car Parking"},{icon:"power-backup",text:"Power Backup"},{icon:"security",text:"24 X 7 Security"},{icon:"lift",text:"Lift",notSupportedPropertyType:["plot"]},{icon:"swimming-pool",text:"Swimming Pool",notSupportedPropertyType:["shop","office"]},{icon:"garden-park",text:"Landscaped Gardens",notSupportedPropertyType:["shop","office"]},{icon:"gym",text:"Gym",notSupportedPropertyType:["shop","office"]},{icon:"children-play",text:"Children's play area",notSupportedPropertyType:["shop","office"]},{icon:"club",text:"Club House",notSupportedPropertyType:["shop","office"]},{icon:"coffe",text:"Cafeteria"},{icon:"golf",text:"Golf Course",notSupportedPropertyType:["shop","office"]},{icon:"multi-purpose-room",text:"Multipurpose Room",notSupportedPropertyType:["shop","office"]},{icon:"football",text:"Sports Facility",notSupportedPropertyType:["shop","office"]},{icon:"weather",text:"Rain Water Harvesting",notSupportedPropertyType:["shop","office"]},{icon:"intercom",text:"Intercom"},{icon:"road",text:"Jogging Track",notSupportedPropertyType:["shop","office"]},{icon:"racket",text:"Indoor Games",notSupportedPropertyType:["shop","office"]},{icon:"maintenance-staff",text:"Maintenance Staff",notSupportedPropertyType:["shop","office"]},{icon:"servant-room",text:"Staff Quarter",notSupportedPropertyType:["shop","office"]},{icon:"vaastu",text:"Vaastu Compliant",notSupportedPropertyType:["shop","office"]},{icon:"malls",text:"Shopping Mall",notSupportedPropertyType:["shop","office"]},{icon:"school",text:"School",notSupportedPropertyType:["shop","office"]},{icon:"hospitals",text:"Hospital",notSupportedPropertyType:["shop","office"]},{icon:"atm",text:"ATM",notSupportedPropertyType:["shop","office"]},{icon:"ac",text:"Air Conditioned",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"cctv-camera",text:"CCTV Camera",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"conference-room",text:"Conference Room",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"fire-sprinklers",text:"Fire Sprinklers",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"wifi",text:"Internet/ Wi-Fi Connectivity",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"ro-water-system",text:"RO Water System",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"service-lift",text:"Service/Goods Lift",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"reserved-parking",text:"Reserved Parking",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"visitor-parking",text:"Visitor Parking",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"water-supply",text:"Water Supply",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]},{icon:"water-storage",text:"Water Storage",notSupportedPropertyType:["apartment","builderfloor","farmhouse","villa","plot","penthouse","studio","independenthouse"]}],pgAmenities:[{icon:"power-backup",text:"Power Backup"},{icon:"security",text:"24 X 7 Security"},{icon:"lift",text:"Lift"},{icon:"swimming-pool",text:"Swimming Pool"},{icon:"gym",text:"Gym"},{icon:"club",text:"Club House"},{icon:"football",text:"Sports Facility"},{icon:"intercom",text:"Intercom"},{icon:"maintenance-staff",text:"Maintenance Staff"},{icon:"gated-community",text:"Gated Community"}],furnishing:[{icon:"sofa",text:"Sofa"},{icon:"fridge",text:"Refrigerator"},{icon:"dining-table",text:"Dining Table"},{icon:"gas",text:"Gas Connection"},{icon:"washing",text:"Washing Machine"},{icon:"wifi-connection",text:"Wifi Connection"},{icon:"microwave",text:"Microwave"},{icon:"modular-kitchen",text:"Modular Kitchen"}],pgFurnishing:[{icon:"sofa",text:"Sofa"},{icon:"fridge",text:"Refrigerator"},{icon:"dining-table",text:"Dining Table"},{icon:"gas",text:"Gas Connection"},{icon:"washing",text:"Washing Machine"},{icon:"pg-geyser",text:"Geyser"},{icon:"pg-water-purifier",text:"Water Purifier"},{icon:"microwave",text:"Microwave"},{icon:"pg-cooler",text:"Cooler"},{icon:"pg-study-room",text:"Study Table"},{icon:"pg-stove",text:"Stove"}],additionalRoom:[{icon:"prayer",text:"Prayer Room"},{icon:"study-room",text:"Study Room"},{icon:"store-room",text:"Store Room"},{icon:"servant-room",text:"Servant Room"}],totalPriceInclude:[{icon:"plc",text:"PLC"},{icon:"parking",text:"Car Parking"},{icon:"club-membership",text:"Club Membership"},{icon:"idc",text:"EDC / IDC"},{icon:"registration",text:"Registration"}],overlooking:[{icon:"garden-park",text:"Garden / Park"},{icon:"swimming-pool",text:"Pool"},{icon:"road",text:"Road"},{icon:"city",text:"Corner Property"}],cParking:[{icon:"parking-covered",text:"Covered"}],oParking:[{icon:"open-parking",text:"Open"}],roomTypes:[{icon:"pg-user-simple",text:"Single Room"},{icon:"pg-2-people",text:"Double Sharing"},{icon:"pg-3-people",text:"Triple Sharing"}],pgCommonAreas:[{icon:"pg-kitchen",text:"Kitchen"},{icon:"pg-sofa",text:"Living Room"},{icon:"pg-study-room",text:"Study Room"}],pgFacilities:[{icon:"pg-meals",text:"Meals Available"},{icon:"pg-cleaning",text:"Daily Cleaning"},{icon:"pg-supervisor",text:"Supervisor"},{icon:"pg-washing-machine",text:"Laundry Service"},{icon:"pg-wifi",text:"Wifi Connection"},{icon:"pg-guard",text:"Security Guard"}],mealTypes:[{icon:"pg-breakfast",text:"Breakfast"},{icon:"pg-lunch",text:"Lunch"},{icon:"pg-dinner",text:"Dinner"}],parkingType:[{icon:"pg-2-wheeler",text:"2 Wheeler"},{icon:"pg-4-wheeler",text:"4 Wheeler"}]},i={totalPriceInclude:["plc","parking","club-membership","idc","registration"]};return{get:function(e){return t[e]},getMasterList:function(e){return o[e]},getFieldList:function(e){return e?i[e]:[]},set:function(e,o){t[e]||(t[e]=[]),o&&-1==t[e].indexOf(o)&&t[e].push(o)},reset:function(e,o){if(t[e])for(var i=t[e].length-1;i>=0;i--)t[e][i]===o&&t[e].splice(i,1)},resetAll:function(e){t[e]&&(t[e]=[])}}}),Box.Application.getService("iconListService")}),define("modules/listProperty/scripts/services/storageService",["services/apiService"],function(){return Box.Application.addService("storageService",function(){var e=(Box.Application.getService("ApiService"),function(e,t){"undefined"!=typeof Storage&&e?sessionStorage[e]=JSON.stringify(t):console.log("Sorry! No Web Storage support..")}),t=function(e){return"undefined"!=typeof Storage&&sessionStorage[e]?JSON.parse(sessionStorage[e]):void 0},o=function(e){sessionStorage.removeItem(e)};return{get:t,set:e,remove:o}}),Box.Application.getService("storageService")}),define("modules/listProperty/scripts/services/completenessScoreService",["common/sharedConfig","modules/controls/scripts/controlsService","modules/iconList/scripts/iconListService","modules/listProperty/scripts/services/storageService"],function(e){return Box.Application.addService("completenessScoreService",function(){function t(){var t=o.get(e.TENANT_PREFERENCES.QUESTIONS_CACHE_KEY),i=0;return t&&t.length>0&&t.forEach(function(t){t.dependency&&o.get(e.TENANT_PREFERENCES.QUESTION_ID_PREFIX+"-"+t.dependency.parentQuestionId)!=t.dependency.dependencyAnswer||i++}),i}var o=Box.Application.getService("controlsService"),i=Box.Application.getService("iconListService"),n=Box.Application.getService("storageService");n.set("completenessScore",0);var r=o.NA.key,s=76,a=107,c=124,p=120,l="payingGuest",d="residential",u=["Description","Facing","area","availableFrom","balconies","bathroom","bed","bookingAmount","carpetArea","date","f-no","howMany","howMany2","kitchen","listingAddress","maintenanceCharges","mBathroom","mLiving","negotiable","openSide","ownershipType","price","propertyAge","propertyType","possession","rentPrice","roadWidth","roleOfUser","securityDeposit","status","total-f","sellType","hostelTotalRooms","vacantSingleRooms","vacantDoubleRooms","vacantTripleRooms","cuisineType","timingRestrictions","lastEntryTime","visitorRestrictions","singleSharingRent","singleSharingDeposit","doubleSharingRent","doubleSharingDeposit","tripleSharingRent","tripleSharingDeposit","laundryCharges","mealCharges","electricityCharges","otherCharges","noticePeriod","parkingAvailable","pgName","preferredTenant","workPreference","otherPreference"],g=function(e){var t={},o=!0,i=!1,n=void 0;try{for(var r,s=u[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var a=r.value;t[a+"ControlUpdated"]={id:a,handler:e,data:[a]}}}catch(c){i=!0,n=c}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw n}}return t},f={sell:{Description:8,Facing:2,area:4,availableFrom:4,balconies:2,bathroom:2,bed:4,bedroom:1,bookingAmount:1,carpetArea:1,date:4,"f-no":1,howMany:1,howMany2:1,kitchen:1,listingAddress:10,maintenanceCharges:2,mBalcony:1,mBathroom:1,mLiving:1,mBedroom:1,mOther:1,negotiable:1,openSide:1,ownershipType:1,price:6,propertyAge:1,propertyType:8,possession:1,rentPrice:6,roadWidth:2,securityDeposit:2,status:2,"total-f":1,sellType:2},rent:{Description:8,Facing:2,area:4,availableFrom:4,balconies:2,bathroom:2,bed:4,bedroom:1,bookingAmount:1,carpetArea:1,date:4,"f-no":1,howMany:1,howMany2:1,kitchen:1,listingAddress:10,maintenanceCharges:2,mapCoords:1,mBalcony:1,mBathroom:1,mBedroom:1,mLiving:1,mOther:1,negotiable:1,openSide:1,ownershipType:1,propertyType:8,price:6,propertyAge:1,possession:1,rentPrice:6,roadWidth:2,roleOfUser:1,securityDeposit:2,sellType:2,status:2,"total-f":1},payingGuest:{propertyType:8,Description:8,Facing:2,bed:4,"f-no":1,negotiable:1,"total-f":1,hostelTotalRooms:4,vacantSingleRooms:4,vacantDoubleRooms:4,vacantTripleRooms:4,cuisineType:1,timingRestrictions:2,lastEntryTime:2,visitorRestrictions:2,singleSharingRent:8,singleSharingDeposit:2,doubleSharingRent:8,doubleSharingDeposit:2,tripleSharingRent:8,tripleSharingDeposit:2,laundryCharges:1,mealCharges:1,electricityCharges:2,otherCharges:1,noticePeriod:2,parkingAvailable:2,pgName:1,preferredTenant:1,workPreference:1,otherPreference:1}},m=function(e){var t=e.id||e.key,o=0,n=i.get(t);if(!n)return o;switch(n=parseInt(n.length,10),n=e.oldVal||n,t){case"amenities":e.oldVal?o=e.oldVal>6?-6:-1*e.oldVal:n>6?o=0:0===n?o="set"===e.action?0:-1.5:1===n?o="set"===e.action?1.5:-1.5:2===n?o="set"===e.action?1.5:-1.5:3===n?o="set"===e.action?1.5:-1.5:4===n?o="set"===e.action?1.5:-1.5:5===n?o="set"===e.action?1.5:-1.5:6===n&&(o="set"===e.action?1.5:0);break;case"totalPriceInclude":case"overlooking":case"additionalRoom":case"furnishing":case"roomTypes":case"pgCommonAreas":case"pgFacilities":case"mealTypes":case"parkingType":e.oldVal?o=e.oldVal>0?-1:0:n>1?o=0:n>0?o="set"===e.action?1:0:0===n&&(o="set"===e.action?0:-1)}return o},h=function(e){var t=e.action,i=o.get("thumbCount"),n=0;switch(t){case"set":case"reset":i>8?n=0:0===i?n="set"===e.action?0:-12:1===i?n="set"===e.action?12:-5:2===i?n="set"===e.action?5:-3:3===i?n="set"===e.action?3:-2:4===i&&(n="set"===e.action?2:-2)}return n},S=function(e){var t=0;return!e.oldVal&&e.newVal&&e.newVal!=r?t=1:!e.newVal&&e.oldVal&&e.oldVal!=r&&(t=-1),t},y=function(){var e=o.get("propertyType");return e=e&&e.toLowerCase(),o.get("listingSubtype")==l?"studio"==e?p:c:"plot"==e?s:a},v=function(e){var i=0,n=y();return"rent"===o.get("SellRent")&&o.get("listingSubtype")==d&&(n+=t()),i=e/n*100,i=i.toFixed(0),i>100?100:i},x=function(e,t){var i=o.get("listingSubtype");if(!i&&"control"==e)return 0;var r=n.get("completenessScore")||0,s=o.get("SellRent"),a=void 0;switch(i==l&&(s=l),e){case"control":var c=void 0,p=f[s][t.data[0]];c=p?p:1,a=S(t)*c,r+=a;break;case"icon":s&&(a=m(t),r+=a);break;case"image":a=h(t),r+=a}return r=0>r?0:r,n.set("completenessScore",r),v(r)};return{getCompletenessScore:x,controlsListners:g}}),Box.Application.getService("completenessScoreService")}),define("modules/listProperty/submodules/tenantPreferences",["doT!modules/listProperty/views/tenantPreferences","services/commonService","services/listingService","common/sharedConfig","modules/controls/scripts/controlsService","modules/listProperty/scripts/services/completenessScoreService"],function(e,t,o,i,n){Box.Application.addModule("tenantPreferences",function(r){function s(){var s=n.get("sellerType")&&n.get("sellerType").toLowerCase();!p.isScreening&&-1==f.indexOf(s)||d||o.getTenantPreferencesQuestionaire().then(function(o){var a=i.TENANT_PREFERENCES.QUESTION_ID_PREFIX,c=e({questionIdPrefix:a,isScreening:p.isScreening,questions:o,dependentPrefix:g.DEPENDENT_QUESTION_CLASS_PREFIX,checkValid:-1!=m.indexOf(s)?"true":"false"});l[0].innerHTML=c,t.startAllModules(l),d=!0,n.set(i.TENANT_PREFERENCES.QUESTIONS_CACHE_KEY,o),o.forEach(function(e){var t=a+"-"+e.id;r.broadcast("show-completeness-score",{score:u.getCompletenessScore("control",{data:[t],newVal:n.get(t)})})}),r.broadcast("show-completeness-score",{score:u.getCompletenessScore()})})}function a(e){e.each(function(e,t){var o=t.getAttribute("id");r.broadcast("show-completeness-score",{score:u.getCompletenessScore("control",{data:[o],oldVal:n.get(o)})}),r.broadcast("SetControlValue",{id:o})})}function c(e,t){if(!isNaN(t)){var o=g.DEPENDENT_QUESTION_CLASS_PREFIX+e.replace(i.TENANT_PREFERENCES.QUESTION_ID_PREFIX,"");l.find("."+o).addClass("hide");var n=o+"-"+t;l.find("."+n).removeClass("hide"),a(l.find("."+o+".hide"))}}var p=void 0,l=void 0,d=!1,u=void 0,g={DEPENDENT_VALIDATION:".js-dependent-validation",DEPENDENT_QUESTION_CLASS_PREFIX:"tenant-preference-dependent"},f=["owner","broker"],m=["owner","broker"];return{init:function(){p=r.getConfig(),u=r.getService("completenessScoreService"),l=$(r.getElement()),s()},destroy:function(){t.unloadModules(r.getElement()),p=null,l=null,u=null},messages:["control-value-change","sellRentChanged","moduleLoaded","listingQuotaFullCheck"],onmessage:function(e,t){switch(e){case"control-value-change":t.moduleId&&t.moduleId.indexOf&&-1!==t.moduleId.indexOf(i.TENANT_PREFERENCES.QUESTION_ID_PREFIX)&&(c(t.moduleId,t.value),r.broadcast("show-completeness-score",{score:u.getCompletenessScore("control",{data:[t.moduleId],newVal:t.value,oldVal:t.oldValue})}));break;case"sellRentChanged":var o=n.get("listingSubtype");("commercial"===o||"sell"===t.value)&&(a(l.find("[data-module='controls']")),l.find(".js-dependent-ques").addClass("hide"));break;case"moduleLoaded":if("controls"===t.name&&0===t.id.indexOf(i.TENANT_PREFERENCES.QUESTION_ID_PREFIX)&&n.get(t.id)){var p=n.get(t.id);r.broadcast("SetControlValue",{id:t.id,key:p}),c(t.id,p)}break;case"listingQuotaFullCheck":s()}}}})});