define("services/gaTrackingService",["common/utilFunctions"],function(e){var n="gaTrackingService";return Box.Application.addService(n,function(n){function t(){var e=m.getQueuedItems({clearQueue:!0});for(var n in e)r(e[n].event,e[n].properties)}function i(){if(g){d=!0;for(var e in g)f("set",u[e],g[e])}}function o(){"function"==typeof f?(t(),i()):setTimeout(o,s)}function r(e,n){"function"==typeof f?(c([e,n]),f("send","event",n.category,e,n.label,n.value||void 0)):(m.addToQueue({event:e,properties:n}),p||(p=!0,o()))}function a(e){g=e,"function"!=typeof f?p||(p=!0,o()):i()}function c(e,n){(l||n)&&("string"==typeof e?console.log(e):console.log.apply(console,e))}var u={sellerId:"dimension3",sellerType:"dimension2",listingSubtype:"dimension68",propertyType:"dimension72"},s=2e3,l=!1,d=!1,g=void 0,p=!1,f=window.ga,v=e.getAllQueryStringParam();v.GA_DEBUG&&(l=!0);var m=new e.MessageQueue({type:"ga-events"});return{trackEvent:r,setIdentity:a}}),Box.Application.getService(n)}),define("services/amplitudeTrackingService",["common/utilFunctions"],function(e){var n="amplitudeTrackingService";return Box.Application.addService(n,function(){function n(){var e=u.getQueuedItems({clearQueue:!0});for(var n in e)i(e[n].event,e[n].properties)}function t(e){require(["amplitude"],function(t){t&&e.amplitudeTrackingId&&(t.getInstance().init(e.amplitudeTrackingId),c=t,n())})}function i(e,n){"undefined"!=typeof c&&"function"==typeof c.getInstance?(a([e,n]),c.logEvent(e,n)):u.addToQueue({event:e,properties:n})}function o(e){"undefined"!=typeof c&&"function"==typeof c.getInstance&&(c.getInstance().setUserId(e.sellerId),c.getInstance().setUserProperties(e))}function r(e,n){var t={url:document.location.href,path:document.location.pathname};i("pageview",t)}function a(e,n){(s||n)&&("string"==typeof e?console.log(e):console.log.apply(console,e))}var c,u;u=new e.MessageQueue({type:"amplitude"});var s=!1,l=e.getAllQueryStringParam();return l.AMPLITUDE_DEBUG&&(s=!0),{trackEvent:i,setIdentity:o,firePageView:r,loadTracking:t}}),Box.Application.getService(n)}),define("services/irisTrackingService",["common/utilFunctions","common/sharedConfig","services/apiService"],function(e,n,t){"use strict";var i="IRISTrackingService";return Box.Application.addService(i,function(){function n(n){e.setcookie("iris_id",n,s,l.toGMTString())}function t(){var t=e.getCookie("iris_id");return t||(t=e.getCookie("ajs_anonymous_id"),t=t?t.replace(/%22/g,""):e.uuidGenerator(),n(t)),t}function i(n,i){c||(c=t());var o=location.hostname.split(".");o.pop(),o.pop(),{message:[{messageId:e.uuidGenerator(),anonymousId:c,event:n,properties:i,url:document.location.href,path:document.location.pathname,title:document.title,userAgent:navigator.userAgent,ip:e.getCookie("USER_IP"),timestamp:Date.now(),userId:a,projectId:window.IRIS_PROJECT_ID}]}}function o(e,n){var t={url:document.location.href,path:document.location.pathname};i("pageview",t)}function r(e){a=e}var a,c,u=e.getSubdomain(),s=window.location.host;s=u?s.replace(u,""):"."+s;var l=new Date(Date.now()+31536e6);return{trackEvent:i,firePageView:o,setIdentity:r}}),Box.Application.getService(i)}),define("modules/gaTracking/scripts/services/gaTracking",["services/utils","services/gaTrackingService","services/amplitudeTrackingService","services/irisTrackingService"],function(e,n,t,i){return Box.Application.addService("gaTracking",function(){function e(e){a("setIdentity",[e])}function o(){a("firePageView")}function r(e){a("loadTracking",[e])}function a(e){var n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];for(var t in c)"function"==typeof c[t][e]&&c[t][e].apply(c[t],n)}var c={ga:n,amplitude:t,iris:i},u=[],s=[],l=[],d=!1,g=Box.Application.getService("Utils"),p=function(e,n,t,i){return"scroll"!==e?void n.on(e,function(){y(t)}):(u.push(i),n.length>0&&s.push(n.offset().top),l.push(t),void(window.onscroll=function(){for(var e=$(window).scrollTop(),n=0;n<s.length;n++)e>s[n]+u[n]&&e<s[n]+u[n]+50&&y(l[n])}))},f=function(e,n,t,i){m(e,n,t,i),v(e,n,t,i)},v=function(e,n,t,i){n.on(e,function(){return n[0].currentTime>=n[0].duration/2&&!d?(t.label="half",void y(t)):void(n[0].currentTime<n[0].duration/2&&(d=!1))})},m=function(e,n,t,i){n.on(e,function(){n[0].currentTime===n[0].duration&&(t.label="full",y(t))})},y=function(e){var n=g.getDeviceType(),t=e.label,i=e.action;n&&!e.noDeviceType&&(t=n+"_"+t,i=n+"_"+i);var o={category:e.category,label:t};e.value&&(o.value=e.value),a("trackEvent",[i,o])};return{trackSection:function(e,n,t,i){return p(e,n,t,i)},trackVideo:function(e,n,t,i){return f(e,n,t,i)},trackVideoDurationFull:function(e,n,t,i){return m(e,n,t,i)},track:function(e){return y(e)},setIdentity:e,firePageView:o,loadAllTracking:r}}),Box.Application.getService("gaTracking")}),define("modules/tracking/scripts/index",["services/sellerService","modules/gaTracking/scripts/services/gaTracking","services/utils"],function(e,n,t){var i="tracking";Box.Application.addModule(i,function(o){function r(e){n.track({category:"seller_app",action:"exited_web",label:e,noDeviceType:!0})}function a(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=(e.sellerId,e.sellerType),o=t.getDeviceType(),a=t.getAllQueryStringParam(),c=a.screen,u=void 0===c?"":c,s=a.cta,l=void 0===s?"":s;o&&(n.track({category:"seller_app",action:"landed_web",label:""+i+(u?";"+u:"")+(l?";"+l:""),noDeviceType:!0}),window.onbeforeunload=function(){r(i+";"+window.location.href)})}function c(){o.broadcast("moduleLoaded",{name:i}),s=o.getConfig(),l.sellerId=s.sellerId,n.loadAllTracking(s.trackingId),n.firePageView(),e.fetchSellerDetails(s.sellerId).then(function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];l.sellerType=e.data&&e.data[0]&&e.data[0].sellerType,n.setIdentity(l),a(l)},function(e){n.setIdentity(l)})}function u(e,n){switch(e){case"webAppExist":r(l.sellerType+";"+window.location.href+";"+n.cta)}}var s=void 0,l={};return{init:c,onmessage:u,messages:["webAppExist"]}})});