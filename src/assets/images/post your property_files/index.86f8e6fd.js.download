var CssEvent={_testSupportedProps:function(e){var n,o=document.createElement("div");for(n in e)if(e.hasOwnProperty(n)&&void 0!==o.style[n])return e[n]},transitionEndEventName:function(){return this._testSupportedProps({transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"})},animationEndEventName:function(){return this._testSupportedProps({animation:"animationend","-o-animation":"oAnimationEnd","-moz-animation":"animationend","-webkit-animation":"webkitAnimationEnd"})},onTransitionEnd:function(e,n){var o=this.transitionEndEventName();$(e).one(o,function(){return n()})},onAnimationEnd:function(e,n){var o=this.animationEndEventName();$(e).one(o,function(){return n()})}};define("modules/popup/scripts/di/css.event",function(){}),define("services/gaTrackingService",["common/utilFunctions"],function(e){var n="gaTrackingService";return Box.Application.addService(n,function(n){function o(){var e=m.getQueuedItems({clearQueue:!0});for(var n in e)a(e[n].event,e[n].properties)}function t(){if(d){l=!0;for(var e in d)v("set",c[e],d[e])}}function i(){"function"==typeof v?(o(),t()):setTimeout(i,u)}function a(e,n){"function"==typeof v?(s([e,n]),v("send","event",n.category,e,n.label,n.value||void 0)):(m.addToQueue({event:e,properties:n}),f||(f=!0,i()))}function r(e){d=e,"function"!=typeof v?f||(f=!0,i()):t()}function s(e,n){(p||n)&&("string"==typeof e?console.log(e):console.log.apply(console,e))}var c={sellerId:"dimension3",sellerType:"dimension2",listingSubtype:"dimension68",propertyType:"dimension72"},u=2e3,p=!1,l=!1,d=void 0,f=!1,v=window.ga,g=e.getAllQueryStringParam();g.GA_DEBUG&&(p=!0);var m=new e.MessageQueue({type:"ga-events"});return{trackEvent:a,setIdentity:r}}),Box.Application.getService(n)}),define("services/amplitudeTrackingService",["common/utilFunctions"],function(e){var n="amplitudeTrackingService";return Box.Application.addService(n,function(){function n(){var e=c.getQueuedItems({clearQueue:!0});for(var n in e)t(e[n].event,e[n].properties)}function o(e){require(["amplitude"],function(o){o&&e.amplitudeTrackingId&&(o.getInstance().init(e.amplitudeTrackingId),s=o,n())})}function t(e,n){"undefined"!=typeof s&&"function"==typeof s.getInstance?(r([e,n]),s.logEvent(e,n)):c.addToQueue({event:e,properties:n})}function i(e){"undefined"!=typeof s&&"function"==typeof s.getInstance&&(s.getInstance().setUserId(e.sellerId),s.getInstance().setUserProperties(e))}function a(e,n){var o={url:document.location.href,path:document.location.pathname};t("pageview",o)}function r(e,n){(u||n)&&("string"==typeof e?console.log(e):console.log.apply(console,e))}var s,c;c=new e.MessageQueue({type:"amplitude"});var u=!1,p=e.getAllQueryStringParam();return p.AMPLITUDE_DEBUG&&(u=!0),{trackEvent:t,setIdentity:i,firePageView:a,loadTracking:o}}),Box.Application.getService(n)}),define("services/irisTrackingService",["common/utilFunctions","common/sharedConfig","services/apiService"],function(e,n,o){"use strict";var t="IRISTrackingService";return Box.Application.addService(t,function(){function n(n){e.setcookie("iris_id",n,u,p.toGMTString())}function o(){var o=e.getCookie("iris_id");return o||(o=e.getCookie("ajs_anonymous_id"),o=o?o.replace(/%22/g,""):e.uuidGenerator(),n(o)),o}function t(n,t){s||(s=o());var i=location.hostname.split(".");i.pop(),i.pop(),{message:[{messageId:e.uuidGenerator(),anonymousId:s,event:n,properties:t,url:document.location.href,path:document.location.pathname,title:document.title,userAgent:navigator.userAgent,ip:e.getCookie("USER_IP"),timestamp:Date.now(),userId:r,projectId:window.IRIS_PROJECT_ID}]}}function i(e,n){var o={url:document.location.href,path:document.location.pathname};t("pageview",o)}function a(e){r=e}var r,s,c=e.getSubdomain(),u=window.location.host;u=c?u.replace(c,""):"."+u;var p=new Date(Date.now()+31536e6);return{trackEvent:t,firePageView:i,setIdentity:a}}),Box.Application.getService(t)}),define("modules/gaTracking/scripts/services/gaTracking",["services/utils","services/gaTrackingService","services/amplitudeTrackingService","services/irisTrackingService"],function(e,n,o,t){return Box.Application.addService("gaTracking",function(){function e(e){r("setIdentity",[e])}function i(){r("firePageView")}function a(e){r("loadTracking",[e])}function r(e){var n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];for(var o in s)"function"==typeof s[o][e]&&s[o][e].apply(s[o],n)}var s={ga:n,amplitude:o,iris:t},c=[],u=[],p=[],l=!1,d=Box.Application.getService("Utils"),f=function(e,n,o,t){return"scroll"!==e?void n.on(e,function(){h(o)}):(c.push(t),n.length>0&&u.push(n.offset().top),p.push(o),void(window.onscroll=function(){for(var e=$(window).scrollTop(),n=0;n<u.length;n++)e>u[n]+c[n]&&e<u[n]+c[n]+50&&h(p[n])}))},v=function(e,n,o,t){m(e,n,o,t),g(e,n,o,t)},g=function(e,n,o,t){n.on(e,function(){return n[0].currentTime>=n[0].duration/2&&!l?(o.label="half",void h(o)):void(n[0].currentTime<n[0].duration/2&&(l=!1))})},m=function(e,n,o,t){n.on(e,function(){n[0].currentTime===n[0].duration&&(o.label="full",h(o))})},h=function(e){var n=d.getDeviceType(),o=e.label,t=e.action;n&&!e.noDeviceType&&(o=n+"_"+o,t=n+"_"+t);var i={category:e.category,label:o};e.value&&(i.value=e.value),r("trackEvent",[t,i])};return{trackSection:function(e,n,o,t){return f(e,n,o,t)},trackVideo:function(e,n,o,t){return v(e,n,o,t)},trackVideoDurationFull:function(e,n,o,t){return m(e,n,o,t)},track:function(e){return h(e)},setIdentity:e,firePageView:i,loadAllTracking:a}}),Box.Application.getService("gaTracking")}),define("modules/popup/scripts/index",["modules/popup/scripts/di/css.event","modules/gaTracking/scripts/services/gaTracking"],function(){Box.Application.addModule("popup",function(e){function n(e){return e.replace(/\s(.)/g,function(e){return e.toUpperCase()}).replace(/\s/g,"").replace(/^(.)/,function(e){return e.toLowerCase()})}function o(e,o){var t,i=window.location.hash.substr(1),a=i?"&":"";o=o||{};var r=g.extend({modal:!0,escKey:!0},o.config),s=g(e+E);s.length&&S.top()!==e&&(t=i+a+n(e.replace(/#|\.|\s/g,"")),C=!0,0!=o.modifyUrl&&(window.location.hash=t),s.removeClass("hide"),p(function(){s.addClass("show-popup"),s.scrollTop(0)},0),S.top()||(g(I).addClass(A),g(b).addClass(A),h.removeClass("hide")),c(e),S.push({popupSelector:e,config:r}),"function"==typeof o.callback&&o.callback())}function t(e){var n=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];return g(v).find(_).removeClass(P),w=e,S.top()?(r(),C=!0,0!=n?window.history.back():a(),!0):!1}function i(){g(window).on("statechange",s).on("hashchange",a),u()}function a(){if("function"==typeof w){var e=w.bind();setTimeout(e,1e3),w=null}}function r(){if(S.top()){var e=S.pop().popupSelector,n=g(e+E);n.removeClass("show-popup"),CssEvent.onTransitionEnd(n[0],function(){if(n.addClass("hide"),S.top()){var e=S.top().popupSelector+E;g(e).removeClass("hide"),c(e)}else g(I).eq(0).removeClass("hide").removeClass("hidden-xs"),g(b).eq(0).removeClass("hide").removeClass("hidden-xs"),h.addClass("hide"),g("body").removeClass("popup-open")}),(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(h.addClass("hide"),n.addClass("hide"),g("body").removeClass("popup-open"))}}function s(){for(var e;e=S.pop();)g(e.popupSelector+E).addClass("hide");h.addClass("hide"),g("body").removeClass("popup-open")}function c(e){y.find(e).length?(k.addClass("hide"),y.removeClass("hide")):(k.removeClass("hide"),y.addClass("hide")),g("body").addClass("popup-open")}function u(){h.on("click",".popup-overlay",function(){return l(),!1}),g(document).bind("keydown",function(e){var n=S.top();n&&27==e.which&&l()})}function p(e){return window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,16)}function l(){var e=S.top();if(e){var n=e.config;m.find(e.popupSelector+E);n.modal!==!0&&(d(),t())}}function d(){var n=S[S.length-1].popupSelector.replace("Popup","").substring(1);e.broadcast("un_load_module",{id:n})}var f,v,g,m,h,y,k,w,T=Box.Application.getService("gaTracking"),C=!1,S=[],I='[data-role="page"]',b="#js-footer",E='[data-role="popup"]',A="",_="[data-popup-overlay]",P="red-alert",x={addImagesClose:{action:"CLICK_Listings_Add Details_Add Images",category:"Seller_Listing",label:"close"}};return S.top=function(){return this.length?this[this.length-1]:void 0},S.empty=function(){this.length=0},{init:function(){v=e.getElement(),g=e.getGlobal("jQuery"),m=g(v),h=m,y=m.find("#common-popup-container"),k=m.find("#page-popup-container"),i(),e.broadcast("moduleLoaded",{name:"popup",id:v.id})},destroy:function(){f=null,v=null,g=null,m=null,h=null,y=null,k=null,C=null,w=null,S=null,I=null,b=null,E=null,A=null},onclick:function(n,o,i){switch(e.broadcast("elementClicked",{element:o,elementType:i}),i){case"closePopup":var a=g(n.target).closest('[data-role="popup"]').attr("id");"addImagesPopup"==a&&T.track(x.addImagesClose);var r=o.dataset,s=r.modifyurl&&"false"==r.modifyurl.toString()?!1:!0;d(),t(null,s),e.broadcast("popup:closed",{popupId:a});break;case"popupOverlay":f.modal!==!0?d():"",l()}},messages:["popup:open","popup:close","popup:destroy","warning-popup"],onmessage:function(e,n){switch(e){case"popup:open":var i="#"+n.id+"Popup";o(i,n.options);break;case"popup:close":n.options&&n.options.callback?t(n.options.callback,n.options.modifyUrl):n.options?t(null,n.options.modifyUrl):t();break;case"warning-popup":g(v).find(_).addClass(P)}}}})});